# farm-service-system
##系统架构
+ 系统拆分
整个系统根据功能拆分成四个子系统，分别是：
 1. 登录系统
 2. 订单系统
 3. 消息系统
 4. 认证系统    
+ 注册中心  
使用Dubbo + Zookeeper搭建“服务注册中心”    
+ 数据库      
使用Redis + MySQL实现大部分的读写分离，并且设定两个数据库的同步规则。Redis负责“读”请求，MySQL主要负责“写”请求。而且Redis还完成Session共享，实现单点登录。  
+ 静态资源加速  
使用Nginx作为静态服务器，处理所有静态资源的请求。  

--------------------------------
系统整个系统的架构如下图：
![alt](/resources/pics/architecture.png)

## 部署说明
### 注意：  
1、我的静态资源请求是由Nginx负责处理，所以需要配置好映射路径；（也可以自己放在项目的资源目录，不过不建议，这样静态资源就局限当前项目的使用）  
2、记得修jsp中的ip地址  
3、项目的运行环境：  
   3.1、安装zookeeper，系统就用Dubbo来进行服务的注册与调用  
   3.2、本项目是基于同一台机器不同端口的分布式（当然如果你机器多，你完全可以部署不同的机器）  
   3.3、安装Redis（因为Redis对windows不怎么友好，所以建议服务器都使用Linux系统，CentOS比较好）  
   3.4、安装mysql，jdk  
   3.5、注意本项目调用了第三方的API（百度的OCR、高德地图的API以及创信的短信接口，自己用自己创建的第三方应用）  
   3.6、安装Tomcat，因为我的消息系统是采用SSM来进行开发，使用WebSocket协议来完成消息推送。而这个需要Tomcat7.x版本以上才可以兼容  
   3.7、注意，我的认证系统需要调用“无人机经营许可”网的查询接口，这个我不知道随着时间的推移会不会有所变化，查询网址：http://uas.ga.caac.gov.cn/login  
   3.8、所有项目都是maven来构建的（对于第一次使用maven的，要先把maven环境构建好）

### 说明：
1、系统分成四个子系统，登录、订单、消息以及认证系统，除了消息系统，其他都是使用springboot进行开发（内嵌Tomcat）所以直接运行即可  
2、yml文件中的一些ip地址也需要修改，要根据自己具体的运行环境来更改  
3、不同系统之间，我采用了门面模式将各个子系统保留接口抽取出来，在项目打包之前，一定要对门面模块（facade结尾的项目）进行打包后，再对对应的系统模块进行打包  
4、数据库名、用户、密码自己要注意  
5、登录系统和订单系统涉及到图片上传，所以一定要创建好对应的目录（都怪我我自己没有加上目录不存在就创建的业务逻辑）  
   对于Linux系统，目录是在根目录创建，目录结构：“/zhku/resources/picture/”  
   对于windows，可以到各个项目中的util包中的FileUtil类进行修改  
6、静态资源文件都在resources下的static目录中：[静态资源文件](https://github.com/LE-xcj/farm-service-system/tree/master/resources/static)

不足之处：
1、当时没能想到有很多类可以抽取出来，形成一个公共模块（例如：工具类、实体类）  
2、视图模板使用jsp，但是springboot不是那么兼容jsp，项目运行的时候很有可能遇到启动失败的问题

### 建议：
1、redis一定要加上密码，否则你的服务器很容易被肉鸡  
2、除了消息系统是打包成war包部署到tomcat之外，其余三个系统都是打包成jar（当然你也可以去掉内置tomcat，自己打包成war部署到tomcat）


### 最后一句：
如果有什么想了解，或者有问题请教。可以发邮件到我的邮箱： 865263907@qq.com
